\chapter{Introduction}

\section{Research Overview}

Agriculture remains a vital component of Sri Lanka's economy. Among the various agricultural products, vegetables constitute an essential part of the domestic food supply chain. However, vegetable markets in Sri Lanka have historically been characterized by high price volatility, which creates substantial challenges for both farmers and consumers. Carrot, being one of the major vegetables traded in the country, experiences frequent and often unpredictable price fluctuations that can severely impact the economic stability of farming communities.

Daily price movements in the Dambulla market reflect complex interactions between multiple factors including weather patterns, fuel costs, regional supply levels, and market demand dynamics. Understanding and predicting these price movements has become increasingly important for stakeholders throughout the agricultural value chain.

This research investigates the application of machine learning techniques to forecast wholesale carrot prices in the Dambulla market. The study explores how climatic conditions, particularly precipitation patterns from major growing regions, along with economic factors such as fuel prices and supply indicators, influence daily price variations. Through the development and comparison of multiple forecasting models, this work aims to identify the most effective approach for short-term price prediction in the context of Sri Lankan vegetable markets.

\section{Problem Statement}

Vegetable price volatility presents serious problems for the agricultural sector in Sri Lanka. Farmers often struggle to make informed decisions about planting schedules, harvest timing, and market entry due to the uncertainty surrounding future prices. When prices drop unexpectedly, farmers may face losses that threaten their financial stability. Conversely, sudden price spikes can lead to affordability issues for consumers while also triggering market interventions that complicate the natural price discovery process.

Traditional approaches to understanding vegetable prices have relied primarily on historical averages and seasonal patterns. However, these methods fail to capture the complex, non-linear relationships between prices and the various factors that influence them. The lack of reliable forecasting tools means that decision-making across the supply chain remains largely reactive rather than proactive. This situation calls for more sophisticated analytical approaches that can better model the temporal dependencies and multi-dimensional influences inherent in agricultural price data.

The challenge is further complicated by the fact that different factors may have varying degrees of influence on prices at different times. For instance, heavy rainfall in major growing regions like Nuwara Eliya might have delayed effects on market prices as supply disruptions gradually propagate through the distribution network. Similarly, changes in fuel prices might impact transportation costs, which in turn affect wholesale pricing. Capturing these temporal lags and interactions requires modeling techniques that can learn from sequential data and account for multiple input variables simultaneously.

\section{Proposed Solution}

This research proposes a comprehensive machine learning framework for carrot price forecasting that addresses the limitations of traditional approaches. The framework consists of two main components: a forecasting engine and an intelligent query system.

The forecasting component employs three distinct modeling approaches to predict daily carrot prices. First, ARIMA models provide a baseline using classical time series analysis techniques. Second, Long Short-Term Memory (LSTM) neural networks are developed in both univariate and multivariate configurations to capture complex temporal patterns. The multivariate LSTM incorporates external factors including precipitation data from eleven growing regions, fuel price indicators, regional supply factors, and market status variables. Third, Random Forest regression serves as an ensemble learning alternative that approaches the problem from a non-sequential perspective.

A rigorous feature selection process underpins the multivariate models. This process combines Random Forest feature importance, Mutual Information scores, and Recursive Feature Elimination to identify the most relevant predictors. The selected features then undergo further validation through an ablation study that systematically assesses the contribution of different feature categories to overall prediction accuracy.

The second component of the framework is a Retrieval-Augmented Generation (RAG) based AI agent that makes the forecasting system accessible and interpretable. This agent stores prediction results in a vector database and uses a large language model to provide natural language responses to user queries. The system can handle both specific date inquiries and analytical questions about price trends, offering stakeholders an intuitive interface for accessing forecasting insights.

\section{Motivation}

Several factors motivated this research. First, there exists a clear practical need for improved price forecasting tools in Sri Lankan agriculture. Farmers, traders, and policymakers all stand to benefit from better price predictions. This research aims to bridge that gap by developing methods specifically tailored to local market conditions.

Second, from a technical perspective, agricultural price forecasting presents interesting challenges that push the boundaries of time series modeling. The need to incorporate diverse data sources, handle irregular patterns, and account for both short-term volatility and longer-term trends makes this a rich problem domain for exploring advanced machine learning techniques. The comparison between sequential models like LSTM and non-sequential approaches like Random Forest offers valuable insights into the nature of temporal dependencies in agricultural price data.

Third, the growing availability of data from various sources creates new opportunities for multivariate forecasting that were not previously feasible. Weather records, fuel price data, and market information can now be integrated more easily, but questions remain about how best to leverage these multiple data streams. This research investigates practical approaches to feature engineering and selection in the context of agricultural forecasting.

Finally, there is broader interest in making machine learning models more interpretable and accessible to end users. The development of the RAG-based AI agent represents an attempt to move beyond simply generating predictions toward creating a system that can explain those predictions and support decision-making in meaningful ways.

\section{Research Objectives}

The primary objectives of this research encompass systematic development and evaluation of agricultural price forecasting models through interconnected phases. The first objective involves collecting and preprocessing historical carrot price data along with relevant meteorological, economic, and market variables from multiple authoritative sources spanning January 2020 to July 2025, ensuring data quality and completeness for robust model training. Building upon this foundation, the second objective focuses on developing and implementing univariate forecasting models using historical price data alone, establishing baseline performance through both traditional ARIMA approaches and modern LSTM neural networks to quantify the predictive power achievable without external variables.

The third objective extends the modeling framework by creating multivariate forecasting models that incorporate external factors including precipitation patterns from major growing regions, fuel price indicators affecting transportation costs, supply indicators reflecting production levels, and temporal features capturing calendar effects, with particular emphasis on rigorous feature selection methods to identify truly relevant predictors among hundreds of candidate variables. Following model development, the fourth objective conducts comprehensive model comparison across ARIMA, univariate LSTM, multivariate LSTM variants, and Random Forest approaches using multiple evaluation metrics including MAPE for percentage error assessment, MAE for absolute error measurement, RMSE for penalizing large errors, and RÂ² scores for explained variance quantification, ensuring thorough performance characterization beyond single metrics.

The fifth objective performs systematic ablation studies that methodically isolate the contribution of different feature categories including weather patterns, supply factors, fuel costs, and temporal variables to forecasting accuracy, providing empirical insights into which external factors most strongly influence carrot prices and validating the value of multivariate modeling. The sixth objective validates model performance through advanced statistical techniques including bootstrap confidence intervals for uncertainty quantification and effect size analysis using Cohen's d to assess practical significance of performance differences, ensuring that observed improvements between models represent genuine advances rather than random variation. The seventh objective develops an AI agent based on Retrieval-Augmented Generation architecture integrating the best-performing forecasting model with natural language processing capabilities, providing an accessible interface through which farmers, traders, and policymakers can query price predictions and obtain analytical insights about price trends and influencing factors without requiring technical expertise. Finally, the eighth objective evaluates the complete forecasting framework considering both prediction accuracy metrics and practical usability for stakeholders across the agricultural supply chain, assessing whether the system delivers actionable value in real-world decision-making contexts beyond purely academic performance benchmarks.

\section{Background}

Sri Lanka's agricultural sector has long been central to the nation's economy and food security. The country's diverse topography and climate zones enable the cultivation of a wide variety of crops, with vegetable farming concentrated primarily in the central highlands. The Nuwara Eliya district, often referred to as the vegetable basket of Sri Lanka, supplies a substantial portion of the country's temperate vegetables including carrots, leeks, and cabbage.

The Dambulla Economic Centre, established in the Matale district, functions as the primary wholesale distribution point for vegetables in Sri Lanka. Daily, thousands of tons of produce arrive from various growing regions, are auctioned in the early morning hours, and are then transported to retail markets across the island. The prices established in Dambulla influence retail pricing throughout the country, making it a crucial barometer for the vegetable market as a whole.

Carrot cultivation in Sri Lanka occurs year-round, though production volumes vary seasonally based on weather conditions in different growing regions. The main growing areas include Nuwara Eliya, Welimada, Bandarawela, and several other locations in the central highlands. These regions experience different rainfall patterns and microclimates, which means that supply from different areas peaks at different times, theoretically providing year-round availability.

However, this system is vulnerable to various disruptions. Excessive rainfall can damage crops and delay harvests, leading to supply shortages. Transportation challenges, whether due to fuel price increases or infrastructure problems, can affect the flow of produce to market. Market dynamics themselves can create volatility, as traders adjust their behavior based on expected future prices, sometimes amplifying rather than dampening price swings.

In recent years, there has been growing recognition of the need for better market information systems in Sri Lankan agriculture. Various government and non-government organizations have made efforts to collect and disseminate market price data, but tools for forecasting future prices have remained limited. This research builds on existing data collection initiatives while introducing more sophisticated analytical capabilities.

\section{Scope of the Research}

This research focuses specifically on wholesale carrot prices in the Dambulla market. While the methodologies developed here could potentially be applied to other vegetables or other markets, the empirical work concentrates on this single commodity in this single location. This focused scope allows for in-depth analysis while maintaining manageable complexity in terms of data collection and model development.

The temporal scope encompasses data from January 2020 through July 2025, providing over five years of daily price observations along with corresponding values for all predictor variables. This period includes both normal market conditions and more volatile periods, including the economic challenges faced by Sri Lanka in recent years, which helps ensure that the models are exposed to a range of market scenarios during training and evaluation.

The research investigates multiple modeling approaches but does not attempt to cover every possible machine learning technique. The selection of ARIMA, LSTM, and Random Forest provides a representative sample spanning traditional statistical methods, deep learning approaches, and ensemble learning techniques. The comparison between these methods aims to identify which characteristics are most important for this particular forecasting problem.

While the research develops an AI agent to make predictions accessible, the focus remains on the forecasting methodology itself. The agent serves primarily as a delivery mechanism for predictions rather than as the central technical contribution. Future work could expand on this component, but for the purposes of this research, the emphasis is on establishing effective forecasting models.